(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60dbcf26"],{"11c1":function(e,t,r){var a=r("c437"),n=r("c64e"),s=n;s.v1=a,s.v4=n,e.exports=s},2366:function(e,t){for(var r=[],a=0;a<256;++a)r[a]=(a+256).toString(16).substr(1);function n(e,t){var a=t||0,n=r;return[n[e[a++]],n[e[a++]],n[e[a++]],n[e[a++]],"-",n[e[a++]],n[e[a++]],"-",n[e[a++]],n[e[a++]],"-",n[e[a++]],n[e[a++]],"-",n[e[a++]],n[e[a++]],n[e[a++]],n[e[a++]],n[e[a++]],n[e[a++]]].join("")}e.exports=n},"23b9":function(e,t,r){"use strict";var a=r("9f89"),n=r.n(a);n.a},"6f1a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[e.isLoading?r("Spinner"):e._e(),r("Sidebar",{attrs:{"selected-page":e.selectedPage},on:{showCreateModal:e.showCreateModal}}),r("div",{staticClass:"user-tweet"},[r("div",{staticClass:"user-tweet-card"},[r("div",{staticClass:"tweet-title"},[r("button",{staticClass:"back-button",on:{click:function(t){return e.$router.back()}}},[r("img",{staticClass:"back-img",attrs:{src:"https://i.imgur.com/aPVTDn2.png",alt:""}})]),e._m(0)]),r("div",{staticClass:"user-tweet-content"},[r("div",{staticClass:"tweet-info"},[r("router-link",{attrs:{to:{name:"user-profile",params:{id:e.tweet.User.id}}}},[r("div",{staticClass:"profile-image"},[r("img",{staticClass:"user-img",attrs:{src:e._f("emptyImage")(e.tweet.User.avatar),alt:""}})])]),r("div",{staticClass:"user-info"},[r("router-link",{staticClass:"user-name-link",attrs:{to:{name:"user-profile",params:{id:e.tweet.User.id}}}},[r("div",{staticClass:"user-name"},[e._v(e._s(e.tweet.User.name))])]),r("div",{staticClass:"user-account"},[e._v("@"+e._s(e.tweet.User.account))])],1)],1),r("div",{staticClass:"tweet"},[r("div",{staticClass:"user-tweet-text"},[e._v(" "+e._s(e.tweet.description)+" ")]),r("div",{staticClass:"create-time"},[e._v(" "+e._s(e._f("formateDateToTime")(e.tweet.createdAt))+"．"+e._s(e._f("formateDate")(e.tweet.createdAt))+" ")])])]),r("div",{staticClass:"action-count"},[r("div",{staticClass:"user-reply-count"},[r("strong",[e._v(e._s(e.tweet.Replies.length))]),e._v("回覆 ")]),r("div",{staticClass:"user-like-count"},[r("strong",[e._v(e._s(e.tweet.Likes.length))]),e._v("喜歡次數 ")])]),r("div",{staticClass:"main-tweet-action"},[r("div",{staticClass:"tweet-reply",on:{click:e.showReplyModal}},[r("img",{staticClass:"reply-icon",attrs:{src:"https://i.imgur.com/SaR8cz3.png",alt:"reply"}})]),e.tweet.isLiked?r("div",{staticClass:"tweet-like"},[r("img",{staticClass:"like-icon",attrs:{src:"https://i.imgur.com/8wXFVUF.png",alt:"like"},on:{click:function(t){return e.deleteLike(e.tweet.id)}}})]):r("div",{staticClass:"tweet-like"},[r("img",{staticClass:"like-icon",attrs:{src:"https://i.imgur.com/qs9Pe3N.png",alt:"like"},on:{click:function(t){return e.addLike(e.tweet.id)}}})])])]),r("UserTweetsList",{attrs:{"page-mode":e.pageMode,"initial-tweets":e.tweets,"main-tweet":e.tweet},on:{showReplyModal:e.showReplyModal}})],1),r("div",{staticClass:"follow-top"},[r("FollowTopList",{attrs:{"initial-is-followed":e.isFollowed}})],1),e.createModal?r("TweetCreateModal",{attrs:{"initial-description":e.description,currentUserData:e.currentUserData},on:{"after-click-close-create":e.closeCreateModal,afterSubmit:e.creatTweetFromModal}}):e._e(),e.replyModal?r("TweetReplyModal",{attrs:{tweet:e.tweet},on:{"after-click-close-reply":e.closeReplyModal,"after-create-reply":e.createReply}}):e._e(),e.editModal?r("UserProfileEditModal",{on:{"after-click-close-edit":e.closeEditModal}}):e._e()],1)},n=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"title-content"},[r("div",{staticClass:"title-name"},[e._v("推文")])])}],s=(r("a434"),r("b0c0"),r("96cf"),r("1da1")),i=r("5530"),c=r("5ea5"),o=r("220b"),l=r("c553"),u=r("8d93"),d=r("811a"),w=r("2708"),f=r("11c1"),p=r("6783"),v=r("2fa3"),m=r("2f62"),g=r("4cce"),h=r("2375"),k={name:"Tweet",mixins:[w["a"]],components:{Sidebar:c["a"],UserTweetsList:o["a"],FollowTopList:l["a"],TweetCreateModal:u["a"],TweetReplyModal:d["a"],Spinner:h["a"]},computed:Object(i["a"])({},Object(m["b"])(["currentUser"])),data:function(){return{createModal:!1,replyModal:!1,editModal:!1,pageMode:"reply",description:"",tweet:{},tweets:[],selectedPage:"",date:"",isFollowed:"",isLoading:!1,currentUserData:{id:"",name:"",account:"",avatar:""}}},created:function(){var e=this.$route.params.id;this.fetchTweet(e),this.fetchReplies(e),this.fetchCurrentUserData(this.currentUser.id)},beforeRouteUpdate:function(e,t,r){var a=e.params.id;this.fetchTweet(a),this.fetchReplies(a),r()},methods:{showCreateModal:function(){this.createModal=!0,console.log(this.createModal)},closeCreateModal:function(){this.createModal=!1},CreateFinish:function(){this.$router.push({name:"tweets-home"})},showReplyModal:function(){this.replyModal=!0},closeReplyModal:function(){this.replyModal=!1},fetchCurrentUserData:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s,i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,g["a"].getUser({userId:e});case 2:a=r.sent,n=a.data,s=n.account,i=n.name,c=n.avatar,t.currentUserData.account=s,t.currentUserData.name=i,t.currentUserData.avatar=c;case 8:case"end":return r.stop()}}),r)})))()},fetchTweet:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isLoading=!0,r.next=4,p["a"].getTweet({tweetId:e});case 4:a=r.sent,n=a.data,t.tweet=n,t.isLoading=!1,r.next=15;break;case 10:r.prev=10,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法取得推文資料，請稍後再試"}),t.isLoading=!1;case 15:case"end":return r.stop()}}),r,null,[[0,10]])})))()},fetchReplies:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,p["a"].getTweetReplies({tweetId:e});case 3:a=r.sent,n=a.data,t.tweets=n,r.next=12;break;case 8:r.prev=8,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法取得推文的回覆內容，請稍後再試"});case 12:case"end":return r.stop()}}),r,null,[[0,8]])})))()},creatTweetFromModal:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,0!==e.length){r.next=4;break}return v["a"].fire({icon:"warning",title:"請輸入推文內容"}),r.abrupt("return");case 4:if(!(e.length>140)){r.next=7;break}return v["a"].fire({icon:"warning",title:"推文字數限制140字以內，請減少輸入的字數"}),r.abrupt("return");case 7:return r.next=9,p["a"].createTweet({description:e});case 9:if(a=r.sent,n=a.data,"error"!==n.status){r.next=13;break}throw new Error(n.message);case 13:t.tweets.splice(0,0,{id:Object(f["v4"])(),userId:t.currentUser.id,createdAt:new Date,description:e,User:{name:t.currentUser.name,account:t.currentUser.account,avatar:t.currentUser.avatar}}),t.CreateFinish(),r.next=21;break;case 17:r.prev=17,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法新增推文，請稍後再試看"});case 21:case"end":return r.stop()}}),r,null,[[0,17]])})))()},createReply:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,a=e.tweetId,n=e.comment,0!==n.length){r.next=5;break}return v["a"].fire({icon:"warning",title:"請輸入回覆內容"}),r.abrupt("return");case 5:if(!(Comment.length>140)){r.next=8;break}return v["a"].fire({icon:"warning",title:"回覆字數限制140字以內，請減少輸入的字數"}),r.abrupt("return");case 8:return r.next=10,p["a"].replyTweet({tweetId:a,comment:n});case 10:if(s=r.sent,i=s.data,"error"!==i.status){r.next=14;break}throw new Error(i.message);case 14:t.tweets.splice(0,0,{tweetId:a,User:{id:t.currentUser.id,name:t.currentUser.name,avatar:t.currentUser.avatar,acount:t.currentUser.account},comment:n,createdAt:new Date}),v["a"].fire({icon:"success",title:"已送出回覆推文"}),t.closeReplyModal(),r.next=23;break;case 19:r.prev=19,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法回覆推文，請稍後再試看"});case 23:case"end":return r.stop()}}),r,null,[[0,19]])})))()},addLike:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,p["a"].addLike({tweetId:e});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:t.tweet.isLiked=!0,v["a"].fire({icon:"success",title:"對方已經收到您的讚囉！"}),t.tweet.Likes.push({id:Object(f["v4"])(),UserId:t.currentUser,TweetId:t.tweet.id}),r.next=16;break;case 12:r.prev=12,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法按讚，請稍後再試"});case 16:case"end":return r.stop()}}),r,null,[[0,12]])})))()},deleteLike:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,console.log("yy",e),r.next=4,p["a"].deleteLike({tweetId:e});case 4:if(a=r.sent,n=a.data,console.log(n),"success"===n.status){r.next=9;break}throw new Error(n.message);case 9:console.log(t.tweet),v["a"].fire({icon:"success",title:"成功取消按讚！"}),t.tweet.isLiked=!1,t.tweet.Likes.splice(0,1),r.next=19;break;case 15:r.prev=15,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法取消按讚，請稍後再試"});case 19:case"end":return r.stop()}}),r,null,[[0,15]])})))()}},filters:{formateDate:function(e){var t=new Date(e),r=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();return r+"年"+a+"月"+n+"日"},formateDateToTime:function(e){var t=new Date(e),r=t.getHours(),a=r-12,n=t.getMinutes();return r>12?"下午"+a+":"+n:"上午"+r+":"+n}}},b=k,C=(r("23b9"),r("2877")),y=Object(C["a"])(b,a,n,!1,null,"b5755efc",null);t["default"]=y.exports},"9f89":function(e,t,r){},c437:function(e,t,r){var a,n,s=r("e1f4"),i=r("2366"),c=0,o=0;function l(e,t,r){var l=t&&r||0,u=t||[];e=e||{};var d=e.node||a,w=void 0!==e.clockseq?e.clockseq:n;if(null==d||null==w){var f=s();null==d&&(d=a=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==w&&(w=n=16383&(f[6]<<8|f[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:o+1,m=p-c+(v-o)/1e4;if(m<0&&void 0===e.clockseq&&(w=w+1&16383),(m<0||p>c)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=p,o=v,n=w,p+=122192928e5;var g=(1e4*(268435455&p)+v)%4294967296;u[l++]=g>>>24&255,u[l++]=g>>>16&255,u[l++]=g>>>8&255,u[l++]=255&g;var h=p/4294967296*1e4&268435455;u[l++]=h>>>8&255,u[l++]=255&h,u[l++]=h>>>24&15|16,u[l++]=h>>>16&255,u[l++]=w>>>8|128,u[l++]=255&w;for(var k=0;k<6;++k)u[l+k]=d[k];return t||i(u)}e.exports=l},c64e:function(e,t,r){var a=r("e1f4"),n=r("2366");function s(e,t,r){var s=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||a)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var c=0;c<16;++c)t[s+c]=i[c];return t||n(i)}e.exports=s},e1f4:function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var a=new Uint8Array(16);e.exports=function(){return r(a),a}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}}}]);
//# sourceMappingURL=chunk-60dbcf26.0cdf8417.js.map