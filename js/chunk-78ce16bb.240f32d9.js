(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78ce16bb"],{"4a39":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[e.isLoading?r("Spinner"):e._e(),r("Sidebar",{attrs:{selectedPage:e.selectedPage},on:{showCreateModal:e.showCreateModal}}),r("div",{staticClass:"main-profile"},[r("UserProfileCard",{attrs:{"initial-user":e.user,"initial-followers":e.followers,"initial-followings":e.followings,"is-myself":e.isMyself,"initial-is-followed":e.isFollowed},on:{showEditModal:e.showEditModal}}),r("UserTweetsList",{attrs:{pageMode:e.pageMode,"initial-tweets":e.tweets},on:{showReplyModal:e.showReplyModal}})],1),r("div",{staticClass:"follow-top"},[r("FollowTopList",{attrs:{"initial-is-followed":e.isFollowed}})],1),e.createModal?r("TweetCreateModal",{attrs:{"initial-description":e.description,currentUserData:e.currentUserData},on:{"after-click-close-create":e.closeCreateModal,afterSubmit:e.creatTweetFromModal}}):e._e(),e.replyModal?r("TweetReplyModal",{attrs:{tweet:e.tweet},on:{"after-click-close-reply":e.closeReplyModal,"after-create-reply":e.createReply}}):e._e(),e.editModal?r("UserProfileEditModal",{attrs:{"initial-user":e.user},on:{"after-click-close-edit":e.closeEditModal,"after-submit":e.handleAfterSubmit}}):e._e()],1)},n=[],s=(r("a434"),r("b0c0"),r("96cf"),r("1da1")),o=r("5530"),i=r("5ea5"),c=r("220b"),l=r("c553"),u=r("8d93"),d=r("811a"),f=r("f8aa"),w=r("7950"),p=r("11c1"),h=r("6783"),m=r("4cce"),v=r("2fa3"),g=r("2f62"),b=r("2375"),M={name:"UserProfile",components:{Sidebar:i["a"],UserTweetsList:c["a"],FollowTopList:l["a"],TweetCreateModal:u["a"],TweetReplyModal:d["a"],UserProfileEditModal:f["a"],UserProfileCard:w["a"],Spinner:b["a"]},computed:Object(o["a"])({},Object(g["b"])(["currentUser"])),data:function(){return{createModal:!1,replyModal:!1,editModal:!1,pageMode:"main",tweets:[],tweet:{},description:"",user:{id:-1,name:"",account:"",avatar:"",cover:"",introduction:""},followers:[],followings:[],isMyself:!1,isFollowed:!1,selectedPage:"profile",isLoading:!1,currentUserData:{id:"",name:"",account:"",avatar:""}}},inject:["reload"],created:function(){var e=this.$route.params.id;this.f,this.fetchUserTweets(e),this.fetchUser(e),this.fetchCurrentUserData(this.currentUser.id)},beforeRouteUpdate:function(e,t,r){var a=e.params.id;this.fetchUserTweets(a),this.fetchUser(a),r()},methods:{showCreateModal:function(){this.createModal=!0},closeCreateModal:function(){this.createModal=!1},CreateFinish:function(){this.$router.push({name:"tweets-home"})},showReplyModal:function(e){this.replyModal=!0,this.tweet=e},closeReplyModal:function(){this.replyModal=!1},showEditModal:function(){this.editModal=!0},closeEditModal:function(){this.editModal=!1},fetchCurrentUserData:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,m["a"].getUser({userId:e});case 2:a=r.sent,n=a.data,s=n.account,o=n.name,i=n.avatar,t.currentUserData.account=s,t.currentUserData.name=o,t.currentUserData.avatar=i;case 8:case"end":return r.stop()}}),r)})))()},fetchUserTweets:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,m["a"].getUserTweets({userId:e});case 3:a=r.sent,n=a.data,t.tweets=n,r.next=12;break;case 8:r.prev=8,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法讀取推文資料，請稍後再試"});case 12:case"end":return r.stop()}}),r,null,[[0,8]])})))()},fetchUser:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s,i,c,l,u,d,f,w;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isLoading=!0,r.next=4,m["a"].getUser({userId:e});case 4:a=r.sent,n=a.data,s=n.id,i=n.name,c=n.account,l=n.avatar,u=n.cover,d=n.introduction,f=n.isMyself,w=n.isFollowed,t.user=Object(o["a"])(Object(o["a"])({},t.user),{},{id:s,name:i,account:c,avatar:l,cover:u,introduction:d}),t.followers=n.Followers,t.followings=n.Followings,t.isMyself=f,t.isFollowed=w,t.isLoading=!1,r.next=20;break;case 15:r.prev=15,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"}),t.isLoading=!1;case 20:case"end":return r.stop()}}),r,null,[[0,15]])})))()},handleAfterSubmit:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,m["a"].updateInfo({userId:t.currentUser.id,formData:e});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:v["a"].fire({icon:"success",title:"儲存成功！"}),t.closeEditModal(),t.reload(),r.next=16;break;case 12:r.prev=12,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法儲存資料，請稍後再試"});case 16:case"end":return r.stop()}}),r,null,[[0,12]])})))()},creatTweetFromModal:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,0!==e.length){r.next=4;break}return v["a"].fire({icon:"warning",title:"沒寫推文內容，不給送出喔！"}),r.abrupt("return");case 4:if(!(e.length>140)){r.next=7;break}return v["a"].fire({icon:"warning",title:"哎呀！推文只能輸入140個字喔！"}),r.abrupt("return");case 7:return r.next=9,h["a"].createTweet({description:e});case 9:if(a=r.sent,n=a.data,"error"!==n.status){r.next=13;break}throw new Error(n.message);case 13:t.tweets.splice(0,0,{id:Object(p["v4"])(),userId:t.currentUser.id,createdAt:new Date,description:e,User:{name:t.currentUser.name,account:t.currentUser.account,avatar:t.currentUser.avatar}}),t.CreateFinish(),r.next=21;break;case 17:r.prev=17,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法新增推文，請稍後再試看"});case 21:case"end":return r.stop()}}),r,null,[[0,17]])})))()},createReply:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,a=e.tweetId,n=e.comment,0!==n.length){r.next=5;break}return v["a"].fire({icon:"warning",title:"請輸入回覆內容"}),r.abrupt("return");case 5:if(!(Comment.length>140)){r.next=8;break}return v["a"].fire({icon:"warning",title:"回覆字數限制140字以內，請減少輸入的字數"}),r.abrupt("return");case 8:return r.next=10,h["a"].replyTweet({tweetId:a,comment:n});case 10:if(s=r.sent,o=s.data,"error"!==o.status){r.next=14;break}throw new Error(o.message);case 14:t.tweet.Replies.push({tweetId:a,comment:n}),v["a"].fire({icon:"success",title:"已送出回覆推文"}),t.closeReplyModal(),r.next=23;break;case 19:r.prev=19,r.t0=r["catch"](0),console.log(r.t0),v["a"].fire({icon:"error",title:"無法回覆推文，請稍後再試看"});case 23:case"end":return r.stop()}}),r,null,[[0,19]])})))()}}},U=M,x=(r("898b8"),r("2877")),k=Object(x["a"])(U,a,n,!1,null,"53170d42",null);t["default"]=k.exports},"898b8":function(e,t,r){"use strict";var a=r("fc69"),n=r.n(a);n.a},fc69:function(e,t,r){}}]);
//# sourceMappingURL=chunk-78ce16bb.240f32d9.js.map