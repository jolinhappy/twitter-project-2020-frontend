(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3824953e"],{6511:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[e.isLoading?r("Spinner"):e._e(),r("Sidebar",{attrs:{"admin-page":e.adminPage,"selected-page":e.selectedPage},on:{showCreateModal:e.showCreateModal}}),r("div",{staticClass:"main-tweets"},[r("div",{staticClass:"tweet-create"},[e._m(0),r("div",{staticClass:"tweet-create-container"},[r("div",{staticClass:"profile-image"},[r("router-link",{attrs:{to:{name:"user-profile",params:{id:e.currentUser.id}}}},[r("img",{staticClass:"user-img",attrs:{src:e._f("emptyImage")(this.currentUserData.avatar),alt:""}})])],1),r("form",{staticClass:"tweet-input"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.description,expression:"description"}],staticClass:"tweet-input-content",attrs:{name:"tweet-input-area",id:"",cols:"30",rows:"10",placeholder:"有什麼新鮮事？"},domProps:{value:e.description},on:{input:function(t){t.target.composing||(e.description=t.target.value)}}}),r("button",{staticClass:"tweet-create-btn",attrs:{type:"submit",disabled:e.isProcessing},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.createTweet(t)}}},[e._v(" 推文 ")])])])]),r("UserTweetsList",{attrs:{"page-mode":e.pageMode,"initial-tweets":e.tweets,"initial-tweet":e.tweet},on:{showReplyModal:e.showReplyModal}})],1),r("div",{staticClass:"follow-top"},[r("FollowTopList")],1),e.createModal?r("TweetCreateModal",{attrs:{"initial-description":e.description,currentUserData:e.currentUserData},on:{"after-click-close-create":e.closeCreateModal,afterSubmit:e.creatTweetFromModal}}):e._e(),e.replyModal?r("TweetReplyModal",{attrs:{tweet:e.tweet},on:{"after-click-close-reply":e.closeReplyModal,"after-create-reply":e.createReply}}):e._e()],1)},n=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tweet-title"},[r("p",[e._v("首頁")])])}],s=(r("a4d3"),r("e01a"),r("a434"),r("b0c0"),r("96cf"),r("1da1")),i=r("5530"),c=r("5ea5"),o=r("220b"),l=r("c553"),u=r("8d93"),d=r("811a"),p=r("6783"),w=r("2fa3"),f=r("2708"),m=r("2f62"),g=r("2375"),h=r("4cce"),v={name:"home",mixins:[f["a"]],components:{Sidebar:c["a"],UserTweetsList:o["a"],FollowTopList:l["a"],TweetCreateModal:u["a"],TweetReplyModal:d["a"],Spinner:g["a"]},data:function(){return{createModal:!1,replyModal:!1,pageMode:"main",tweets:[],description:"",tweet:{},adminPage:!1,selectedPage:"home",isProcessing:!1,isLoading:!1,currentUserData:{id:"",name:"",account:"",avatar:""}}},computed:Object(i["a"])({},Object(m["b"])(["currentUser"])),created:function(){this.fetchUserTweets(),this.fetchCurrentUserData(this.currentUser.id)},beforeRouteUpdate:function(e,t,r){r()},methods:{showCreateModal:function(){this.createModal=!0},closeCreateModal:function(){this.createModal=!1},showReplyModal:function(e){this.replyModal=!0,this.tweet=e},closeReplyModal:function(){this.replyModal=!1},fetchCurrentUserData:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s,i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,h["a"].getUser({userId:e});case 2:a=r.sent,n=a.data,s=n.account,i=n.name,c=n.avatar,t.currentUserData.account=s,t.currentUserData.name=i,t.currentUserData.avatar=c;case 8:case"end":return r.stop()}}),r)})))()},fetchUserTweets:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,p["a"].getTweets();case 4:r=t.sent,a=r.data,e.tweets=a,e.isLoading=!1,t.next=15;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0),w["a"].fire({icon:"error",title:"無法取得推文資料，請稍後再試"}),e.isLoading=!1;case 15:case"end":return t.stop()}}),t,null,[[0,10]])})))()},createTweet:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.isProcessing=!0,0!==e.description.length){t.next=5;break}return w["a"].fire({icon:"warning",title:"沒寫推文內容，不給送出喔！"}),t.abrupt("return");case 5:if(!(e.description.length>140)){t.next=8;break}return w["a"].fire({icon:"warning",title:"哎呀！推文只能輸入140個字喔！"}),t.abrupt("return");case 8:return t.next=10,p["a"].createTweet({description:e.description});case 10:if(r=t.sent,a=r.data,console.log(a),"error"!==a.status){t.next=15;break}throw new Error(a.message);case 15:console.log(a.UserId),e.tweets.splice(0,0,{id:a.id,description:e.description,createdAt:new Date,User:{id:a.UserId,name:e.currentUser.name,account:e.currentUser.account,avatar:e.currentUser.avatar},Likes:[]}),w["a"].fire({icon:"success",title:"送出熱騰騰的推文囉！"}),e.isProcessing=!1,e.description="",t.next=27;break;case 22:t.prev=22,t.t0=t["catch"](0),console.log(t.t0),w["a"].fire({icon:"error",title:"無法新增推文，請稍後再試"}),e.isProcessing=!1;case 27:case"end":return t.stop()}}),t,null,[[0,22]])})))()},creatTweetFromModal:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,0!==e.length){r.next=4;break}return w["a"].fire({icon:"warning",title:"沒寫推文內容，不給送出喔！"}),r.abrupt("return");case 4:if(!(e.length>140)){r.next=7;break}return w["a"].fire({icon:"warning",title:"哎呀！推文只能輸入140個字喔！"}),r.abrupt("return");case 7:return r.next=9,p["a"].createTweet({description:e});case 9:if(a=r.sent,n=a.data,"error"!==n.status){r.next=13;break}throw new Error(n.message);case 13:w["a"].fire({icon:"success",title:"送出熱騰騰的推文囉！"}),t.tweets.splice(0,0,{id:n.id,createdAt:new Date,description:e,User:{id:n.UserId,name:t.currentUser.name,account:t.currentUser.account,avatar:t.currentUser.avatar},Likes:[]}),t.closeCreateModal(),t.description="",r.next=23;break;case 19:r.prev=19,r.t0=r["catch"](0),console.log(r.t0),w["a"].fire({icon:"error",title:"無法新增推文，請稍後再試看"});case 23:case"end":return r.stop()}}),r,null,[[0,19]])})))()},createReply:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,a=e.tweetId,n=e.comment,console.log(n),0!==n.length){r.next=6;break}return w["a"].fire({icon:"warning",title:"請輸入回覆內容"}),r.abrupt("return");case 6:return r.next=8,p["a"].replyTweet({tweetId:a,comment:n});case 8:if(s=r.sent,i=s.data,"error"!==i.status){r.next=12;break}throw new Error(i.message);case 12:t.tweet.Replies.push({tweetId:a,comment:n}),w["a"].fire({icon:"success",title:"已送出回覆推文"}),t.closeReplyModal(),r.next=21;break;case 17:r.prev=17,r.t0=r["catch"](0),console.log(r.t0),w["a"].fire({icon:"error",title:"無法回覆推文，請稍後再試看"});case 21:case"end":return r.stop()}}),r,null,[[0,17]])})))()}}},b=v,U=(r("dd42"),r("2877")),M=Object(U["a"])(b,a,n,!1,null,"a0618c9a",null);t["default"]=M.exports},"6c49":function(e,t,r){},dd42:function(e,t,r){"use strict";var a=r("6c49"),n=r.n(a);n.a}}]);
//# sourceMappingURL=chunk-3824953e.d23e68ee.js.map